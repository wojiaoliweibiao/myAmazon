{:widget('Blog/header')}

    <script src="__STATIC__/index/js/c556be63d1234f3bb4022c5dcd4be9d4.js"></script>

    <script src="__STATIC__/index/js/8e1680447bbd4e069b0a62c61310c8f2.js"></script>

    <script src="__STATIC__/index/js/hg.common.js"></script>

    <script src="__STATIC__/index/js/jquery.fancybox.js"></script>

    <link href="__STATIC__/index/css/jquery.fancybox.css" rel="stylesheet"/>

    <!--[if lt IE 9]>
      <script src="__STATIC__/index/js/html5shiv.min.js"></script>
      <script src="__STATIC__/index/js/respond.min.js"></script>
    <![endif]-->
    {:widget('Blog/left')}
                
<link href="css/bootstrap-switch.min.css" rel="stylesheet"/>

<script src="js/bootstrap-switch.min.js"></script>

<ul id="divTabPanel" class="nav nav-tabs" role="tablist">
    <li id="liTabApiUser" role="presentation" class="active"><a href="javascript:void(0);">电商平台买家账号</a></li>
</ul>
<div id="divTabContentPanel" class="tab-content">
    <div id="tabContent_liTabApiUser" role="tabpanel" class="tab-pane fade active in">
        <div style="padding-left:20px; margin-bottom:20px;" class="panel panel-default">
<form action="/BuyerUser?Length=9" class="form-horizontal" data-ajax="true" data-ajax-mode="replace" data-ajax-update="#p333607190divDataList" id="searchForm" method="post" style="margin-bottom:12px">                <div style="margin-right:20px; text-align:right;margin-top:10px;">
                    <button type="button" class="btn btn-info" onclick="p333607190doEditData()"><i class="glyphicon glyphicon-plus"></i> <hg:trans>绑定买家账号</hg:trans></button>
                    <button type="button" class="btn btn-info hide" onclick="p333607190doTestGetBuyerOrder()"><i class="glyphicon glyphicon-cog"></i> <hg:trans>测试1688订单</hg:trans></button>
                    <button type="button" class="btn btn-info hide" onclick="p333607190doTestGetOrderLogistic()"><i class="glyphicon glyphicon-cog"></i> <hg:trans>测试1688采购订单</hg:trans></button>
                    
                    <input type="hidden" value="" id="OpenBatchAddRole" />
                </div>
                <div class="form-group" style="max-width:450px;" id="Search">
                    <div class="input-group input-group-sm">
                        <input type="text" name="txtSearchKey" style="margin-right:20px" id="txtSearchKey" class="form-control" placeholder="店铺名称" />
                        <span class="input-group-btn">
                            <input type="submit" value="搜索(S)" hgtrans="true" accesskey="S" id="sb" class="btn btn-primary" />
                        </span>
                    </div>
                </div>
                <input type="hidden" id="hidUserType" name="hidUserType" value="" />
</form>        </div>
        <div class="status-group">
            <label itemid="" class="active"><a><hg:trans>全部</hg:trans></a><span></span></label>
            
        </div>
        <div id="p333607190divDataList">
            <table class="table table-bordered table-hover">
    <thead>
        <tr>
            <th style="width:3%;">
                <input type="checkbox" name="chk_all" id="chk_all" onclick="p333607190doSetCheckBox(this)" />
            </th>
            <th style="width:6%"><hg:trans>买家名称</hg:trans></th>
            <th style="width:6%"><hg:trans>平台</hg:trans></th>
            <th style="width:6%"><hg:trans>账号ID</hg:trans></th>
            <th style="width:5%"><hg:trans>账号状态</hg:trans></th>
            <th style="width:6%">
                <p>
                    <hg:trans>创建者</hg:trans>
                </p>
                <hg:trans>创建时间</hg:trans>
            </th>
            <th style="width:10%"><hg:trans>操作</hg:trans></th>
        </tr>
    </thead>
    <tbody>
    </tbody>
</table>

        </div>
    </div>
</div>
<!-- Modal-->
<div class="modal fade" id="batchSetBatchModal" tabindex="-1" role="dialog" aria-labelledby="batchSetBatchModalLabel" aria-hidden="true" style="padding-top:150px;">
    <div class="modal-dialog" style="width:850px;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="batchSetBatchModalLabel"><hg:trans>批量设置权限</hg:trans></h4>
            </div>
            <div class="modal-body">
                <div class="panel-body">
                    <div class="form-group">
                        <label for="txtUserForm" class="control-label col-sm-1" style="width:60px !important;margin-right:5px;"><hg:trans>人员</hg:trans></label>
                        <div id="divStoreItemsSync" class="input-group para-items">
                            <span data-value="">全部</span>
                                <span itemid="19">苗贵鹏 (  )</span>
                                <span itemid="20">苗小云 (  )</span>
                                <span itemid="21">郝军龙 (  )</span>
                                <span itemid="22">张飞 (  )</span>
                                <span itemid="23">cheerwsn (  )</span>
                                <span itemid="27">杜艳萍 (  )</span>
                                <span itemid="28">王艳军 (  )</span>
                                <span itemid="29">高海龙 (  )</span>
                                <span itemid="30">白艳飞 (  )</span>
                                <span itemid="31">苗海云 (  )</span>
                                <span itemid="32">张艳荣 (  )</span>
                                <span itemid="33">高利军 (  )</span>
                                <span itemid="34">吕彩锋 (  )</span>
                                <span itemid="35">苗艳梅 (  )</span>
                                <span itemid="36">崔新宇 (  )</span>
                                <span itemid="37">刘睿 (  )</span>
                                <span itemid="38">苗利军 (  )</span>
                                <span itemid="39">冯状 (  )</span>
                                <span itemid="40">刘晓瑶 (  )</span>
                                <span itemid="41">樊港港 (  )</span>
                                <span itemid="42">孙婷婷 (  )</span>
                                <span itemid="43">白萌 (  )</span>
                                <span itemid="44">许璐 (  )</span>
                                <span itemid="45">郭建珍 (  )</span>
                                <span itemid="46">薛海存 (  )</span>
                                <span itemid="47">王燕香 (  )</span>
                                <span itemid="48">尹琪梦 (  )</span>
                                <span itemid="49">高俊伟 (  )</span>
                                <span itemid="50">韩江龙 (  )</span>
                                <span itemid="51">魏泽平 (  )</span>
                                <span itemid="52">刘静 (  )</span>
                                <span itemid="53">张曼微 (  )</span>
                                <span itemid="54">吕瑞芳 ( guojianzhen )</span>
                                <span itemid="55">陈小燕 (  )</span>
                                <span itemid="56">史岱 (  )</span>
                                <span itemid="57">高卫峰 (  )</span>
                                <span itemid="58">宋健 (  )</span>
                                <span itemid="59">张艳伟 (  )</span>
                                <span itemid="60">赵敏 (  )</span>
                                <span itemid="61">王乾 (  )</span>
                                <span itemid="62">王鑫磊 (  )</span>
                                <span itemid="63">崔新雅 (  )</span>
                                <span itemid="64">田峰 (  )</span>
                                <span itemid="65">张弘 (  )</span>
                                <span itemid="66">李媛 (  )</span>
                                <span itemid="67">郝军娥 (  )</span>
                                <span itemid="68">樊艳军 (  )</span>
                                <span itemid="69">白伟连 (  )</span>
                                <span itemid="70">韩晋 (  )</span>
                                <span itemid="71">高海峰 (  )</span>
                                <span itemid="72">姚青琴 (  )</span>
                                <span itemid="73">郝东元 (  )</span>
                                <span itemid="74">李保明 (  )</span>
                                <span itemid="75">王然 (  )</span>
                                <span itemid="76">马艳伟 (  )</span>
                                <span itemid="77">田晓雄 (  )</span>
                                <span itemid="78">王彦杰 (  )</span>
                                <span itemid="79">王庆 (  )</span>
                                <span itemid="80">郭秋爱 (  )</span>
                                <span itemid="81">苗小娥 (  )</span>
                                <span itemid="82">张沁松 (  )</span>
                                <span itemid="83">乔志梅 (  )</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal"><hg:trans>关闭</hg:trans></button>
                <button type="button" class="btn btn-primary" id="btnStartSyncStock" onclick="p333607190doBatchAddRole()"><hg:trans>确定</hg:trans></button>
            </div>
        </div>
    </div>
</div>
<!-- Modal -->
<script type="text/javascript">
    function  p333607190doSetCheckBox(obj) {
        $("input[name=chk_list]").prop("checked", $(obj).prop("checked"));
    }
    //确认批量添加权限
    function p333607190doBatchAddRole() {
        var apiuserIds = $("input[name=chk_list]:checked").map(function () { return $(this).val(); }).get().join(",");
        if (!apiuserIds) {
            redgle.showMessage(translate.format("<hg:trans>请先选择店铺！</hg:trans>"))
            return;
        }
        var roleIds = $("#divStoreItemsSync").find(".active[itemid]").map(function () { return $(this).attr("itemid"); }).get().join(",");
        $.ajax({
            url: "/ApiUser/BatchSetApiUserRole",
            type: "post",
            data: { apiUserIds: apiuserIds, roleIds: roleIds, State: $("#OpenBatchAddRole").val() },
            success: function (data) {
                redgle.showMessage(translate.format("<hg:trans>{0}</hg:trans>", [data.Message]))
p333607190doReloadData()
                $("#batchSetBatchModal").modal("hide")
            },
            error: function (e) {
                console.log(e)
                redgle.showMessage(translate.format("<hg:trans>操作失败！</hg:trans>"))
            }
        })
    }

    //打开批量添加权限
    function p333607190doOpenBatchAddRole(obj) {
        $("#OpenBatchAddRole").val(obj);
        var apiuserIds = $("input[name=chk_list]:checked").map(function () { return $(this).val(); }).get().join(",");
        if (!apiuserIds) {
            redgle.showMessage(translate.format("<hg:trans>请先选择店铺！</hg:trans>"))
            return;
        }
        $("#batchSetBatchModal").modal("show")
    }


    function p333607190doReloadData() {
        var pageIndex = $("#flickrpager").attr("data-ajax-currentpage");
        if (typeof (pageIndex) == "undefined")
            pageIndex = "1";

        var postData = redgle.request.getFormData("searchForm");
        postData["pageIndex"] = pageIndex;

        $.ajax({
            type: "POST",
            url: "/BuyerUser",
            data: postData,
            datatype: "text",
            success: function (data) {
                $("#p333607190divDataList").html(data);
            },
            error: function () {
                alert(translate.format("<hg:trans>重新加载数据失败！</hg:trans>"));
            }
        });
    }

    jQuery(function () {
        redgle.tab.init({ tabPanel: "divTabPanel", contentPanel: "divTabContentPanel" });
        $("#divChooseTypeItems>span").click(function () {
            var $this = $(this)
            if ($this.attr("class") == "active") {
            } else {
                $this.parent().find("span").prop("class", "")
                $this.prop("class", "active")
                $this.parent().find("input").prop("value", $this.attr("data-value"))
            }
        });

        $("#divStoreItemsSync>span").click(function () {
            var $this = $(this);
            if ($this.attr("class") == "active") {
                if ($this.attr("data-value") == "") {
                    $("#divStoreItemsSync>span").removeClass("active")
                } else {
                    $("#divStoreItemsSync>span[data-value='']").removeClass("active")
                    $this.removeClass();
                }

            } else {
                if ($this.attr("data-value") == "") {
                    $("#divStoreItemsSync>span").removeClass("active")
                    $("#divStoreItemsSync>span").addClass("active")
                } else {
                    $this.addClass("active");
                }
            };
        });

        //分组类型绑定事件
        $(".status-group>label").each(function () {
            $(this).click(function () {
                var itemid = $(this).attr("itemid");
                $("#hidUserType").val(itemid);
                $(".status-group>label").removeClass("active");
                $(".status-group>label[itemid='" + itemid + "']").addClass("active");
                $("#searchForm").submit();
            });
        });

    });

    function p333607190doEditData(id) {
        if (id == null || id == "")
            id = "";
        var url = "/BuyerUser/Edit/" + id;
        redgle.tab.create("liBuyerUserEdit", url, translate.format("<hg:trans>买家账号信息</hg:trans>"));
    }

    function p333607190doApiUserRole(id) {
        if (id == null || id == "")
            return;

        var url = "/ApiUser/SetUserRole/" + id;
        redgle.tab.create("liSetUserRole", url, translate.format("<hg:trans>分配店铺权限</hg:trans>"));
    }

    function p333607190doEditEmailToken(id) {
        if (id == null || id == "")
            id = "";

        var url = "/ApiUser/EmailToken?apiUserId=" + id;
        redgle.tab.create("liEmailToken", url, translate.format("<hg:trans>绑定邮箱</hg:trans>"));
    }

    function p333607190doDelEmailToken(id) {
        if (confirm(translate.format("确认要解除当前邮箱绑定吗？"))) {
            $.ajax({
                url: "/ApiUser/delEmailToken",
                type: "post",
                data: { apiUserIds: id },
                success: function (data) {
                    if (data.error) {
                        redgle.showMessage(data.Message);
                    } else {
p333607190doReloadData();
                    }
                },
                error: function (e) {
                    console.log(e)
                    redgle.showMessage(translate.format("<hg:trans>操作失败！</hg:trans>"))
                }
            });
        }
    }

    function p333607190doTestGetBuyerOrder() {
        $.ajax({
            url: "/BuyerUser/TestGetBuyerOrder",
            type: "post",
            data: {},
            success: function (data) {
                if (data.error) {
                    redgle.showMessage(data.Message);
                }
            },
            error: function (e) {
                console.log(e)
                redgle.showMessage(translate.format("<hg:trans>操作失败！</hg:trans>"))
            }
        });
    }

    function p333607190doTestGetOrderLogistic() {
        $.ajax({
            url: "/BuyerUser/TestGetOrderLogistic",
            type: "post",
            data: {},
            success: function (data) {
                if (data.error) {
                    redgle.showMessage(data.Message);
                }
            },
            error: function (e) {
                console.log(e)
                redgle.showMessage(translate.format("<hg:trans>操作失败！</hg:trans>"))
            }
        });
    }

    function doShowPopoverMessage(event) {
        var src = event.target || window.event.srcElement;
        if ($(src).attr("status") == "uncreate") {
            $(src).popover({
                content: $(src).attr("failed"),
                html: true,
                placement: 'top',
                trigger: 'hover',
                container: "body",
                title: translate.format("<hg:trans>店铺授权异常</hg:trans>")
            });
            $(src).attr("status", "unload");
            $(src).popover('show');
        }
    }


    var CheckCurrentUserId;
    function GetCurrentUserid() {
        return CheckCurrentUserId;
    }
    //图片水印设置
    function p333607190doEditWaterMark(apiUserid) {
        CheckCurrentUserId = apiUserid;
        var url = "/ApiUser/SetUpWaterMark?apiUserid=" + apiUserid;
        redgle.tab.create("liWishPublishBatchEdit", url, translate.format("<hg:trans>设置水印</hg:trans>"));
    }

    function ReloadList() {
p333607190doReloadData();
    }



</script>
<script src="js/jquery.unobtrusive-ajax.min.js"></script>

            </div>
    </div>
    <div style="clear:both; height:10px;">
    </div>

    

    
    <div class="waitting" id="divAjaxLoadingPanel" style="display:none;" tabindex="-1">
        <div class="spinner">
            <div class="bounce1"></div>
            <div class="bounce2"></div>
            <div class="bounce3"></div>
        </div>
    </div>
    <div class="scroll-to-top" style="display:none;" title="返回顶部">
        <i class="glyphicon glyphicon-chevron-up"></i>
    </div>
    <div class="scroll-to-bottom" style="display:none;" title="滚动到底部">
        <i class="glyphicon glyphicon-chevron-down"></i>
    </div>
    <script language="javascript" type="text/javascript">
        $(function () {
            $(document).scroll(function () {
                initScrollButtonState();
            });

            $(".scroll-to-top").click(function () {
                $('html,body').animate({ scrollTop: '0px' }, 200);
            });

            $(".scroll-to-bottom").click(function () {
                var h = $(document).height() - $(window).height();
                $('html,body').animate({ scrollTop: h+'px' }, 200);
            })
        });

        $(document).ready(function () {
            initScrollButtonState();
        });
        
        function initScrollButtonState() {
            var scroll = $(document).scrollTop();
            if (scroll < 10) {
                $(".scroll-to-top").css("display", "none");
            }
            else {
                $(".scroll-to-top").css("display", "");
            }

            var h = $(document).height() - $(window).height();
            if (h < 10) {
                $(".scroll-to-bottom").css("display", "none");
            }
            else {
                if (h - scroll < 10) {
                    $(".scroll-to-bottom").css("display", "none");
                }
                else {
                    $(".scroll-to-bottom").css("display", "");
                }
            }
        }

        $(".menucontrol> span").click(function () {
            var parentPenel = $(this).parents(".menucontrol");
            if (parentPenel.attr("class").indexOf("menuhide") >= 0) {
                $(".top_panel").removeClass("menuhide");
                $(".left_panel").removeClass("menuhide");
                $(".menucontrol").removeClass("menuhide");
                $(".content_panel").removeClass("menuhide");
            }
            else {
                $(".top_panel").addClass("menuhide");
                $(".left_panel").addClass("menuhide");
                $(".menucontrol").addClass("menuhide");
                $(".content_panel").addClass("menuhide");
            }
        });
    </script>
</body>
</html>